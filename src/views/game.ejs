<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<title>3D Pong</title>
		<script type="importmap">
			{
				"imports": {
					"three": "https://cdn.jsdelivr.net/npm/three@0.182.0/build/three.module.js",
					"three/addons/": "https://cdn.jsdelivr.net/npm/three@0.182.0/examples/jsm/"
				}
			}
		</script>
		<style>
			body {
				position: relative;
				margin: 0;
			}

			#chat {
				background: rgba(0, 0, 0, 25%);
				position: absolute;
				top: 0;
				left: 0;
				padding: 1rem;
			}

			#chat__text {
				font-family: sans-serif;
				margin: 0;
				color: white;
				font-size: 1.1rem;
				height: 10rem;
				width: 45ch;
				overflow-y: auto;
				white-space: pre-wrap;
			}

			#chat__box {
				width: 100%;
				background: transparent;
				color: white;
				border: 1px solid grey;
			}

			#lobby-info {
				position: absolute;
				left: 50%;
				right: 50%;
				bottom: 2rem;
				color: white;
				font-family: monospace;
				text-align: center;
				width: min-content;
				transform: translateX(-50%);
			}

			#game-controls {
				position: absolute;
				top: 1rem;
				left: 50%;
				transform: translateX(-50%);
				display: flex;
				align-items: center;
				gap: 0.75rem;
				color: white;
				font-family: sans-serif;
				background: rgba(0, 0, 0, 0.35);
				border: 1px solid rgba(255, 255, 255, 0.2);
				border-radius: 0.75rem;
				padding: 0.5rem 0.75rem;
			}

			#host-badge {
				font-weight: 700;
				color: #ffd447;
			}

			#waiting {
				position: fixed;
				inset: 0;
				display: flex;
				align-items: center;
				justify-content: center;
				background: radial-gradient(circle at center, rgba(0,0,0,0.6), rgba(0,0,0,0.85));
				font-family: sans-serif;
			}

			#waiting__card {
				background: rgba(0, 0, 0, 0.4);
				border: 1px solid rgba(255, 255, 255, 0.15);
				border-radius: 12px;
				padding: 2rem;
				width: 45ch;
				backdrop-filter: blur(8px);
				box-shadow: 0 0 25px rgba(0, 0, 0, 0.6);
			}

			#waiting__title {
				margin: 0 0 1rem 0;
				color: white;
				font-size: 1.5rem;
				letter-spacing: 0.05em;
			}

			#waiting__players {
				margin: 0 0 1.5rem 0;
				color: white;
				font-size: 1.1rem;
				max-height: 10rem;
				overflow-y: auto;
			}

			#waiting__players span {
				display: flex;
				justify-content: space-between;
				align-items: center;
				padding: 0.25rem 0;
				border-bottom: 1px solid rgba(255,255,255,0.08);
			}

			#waiting__players span:last-child {
				border-bottom: none;
			}

			#startButton {
				width: 100%;
				padding: 0.75rem;
				font-size: 1rem;
				border-radius: 8px;
				border: 1px solid rgba(255,255,255,0.2);
				background: rgba(255,255,255,0.1);
				color: white;
				cursor: pointer;
				transition: all 0.2s ease;
			}

			#startButton:hover:not(:disabled) {
				background: rgba(255,255,255,0.2);
				transform: translateY(-1px);
			}

			#startButton:active:not(:disabled) {
				transform: translateY(0);
			}

			#startButton:disabled {
				opacity: 0.4;
				cursor: not-allowed;
			}

			.waiting__controls {
				display: flex;
				align-items: center;
				justify-content: space-between;
				margin-bottom: 1rem;
				color: white;
			}

			.visibility-buttons {
				display: flex;
				gap: 0.4rem;
			}

			.visibility-button {
				width: auto;
				padding: 0.25rem 0.6rem;
				font-size: 0.8rem;
				border-radius: 999px;
				border: 1px solid rgba(255,255,255,0.3);
				background: rgba(255,255,255,0.08);
				color: white;
				cursor: pointer;
			}

			.visibility-button.active {
				background: rgba(255,255,255,0.28);
			}

			.visibility-button:disabled {
				opacity: 0.5;
				cursor: not-allowed;
			}

			.kick-button {
				width: auto;
				padding: 0.25rem 0.5rem;
				font-size: 0.8rem;
				border-radius: 6px;
				border: 1px solid rgba(255,255,255,0.2);
				background: rgba(255,255,255,0.1);
				color: white;
				cursor: pointer;
			}

			.leave-button {
				width: auto;
				padding: 0.55rem 0.9rem;
				border-radius: 8px;
				border: 1px solid rgba(255,255,255,0.3);
				background: rgba(214, 58, 58, 0.35);
				color: white;
				cursor: pointer;
			}
		</style>
	</head>
	<body>
		<div id="chat">
			<pre id="chat__text"></pre>
			<input id="chat__box" placeholder="Chat (press Enter)" />
		</div>

		<div id="waiting">
			<div id="waiting__card">
				<p id="waiting__title">Waiting for players...</p>
				<div class="waiting__controls">
					<span>Lobby visibility</span>
					<div class="visibility-buttons">
						<button id="waitingPublicButton" class="visibility-button active">Public</button>
						<button id="waitingPrivateButton" class="visibility-button">Private</button>
					</div>
				</div>
				<div id="waiting__players"></div>
				<button id="startButton" disabled>Start Game</button>
				<button id="waitingLeaveButton" class="leave-button" style="margin-top: 0.75rem;">
					Leave Game
				</button>
			</div>
		</div>

		<div id="lobby-info">
			Join Code<br /><span style="font-size: 2rem"><%= code %></span>
		</div>
		<div id="game-controls">
			<span id="host-badge"></span>
			<button id="inGameKickButton" class="kick-button">Kick Opponent</button>
			<button id="inGameLeaveButton" class="leave-button">Leave Game</button>
		</div>
		<script type="module" src="/main.js"></script>
	</body>
</html>
